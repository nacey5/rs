<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="dao.OrganizatorDao">
    <cache eviction="FIFO" flushInterval="300000" readOnly="false"/>

    <!--Organizer selectInfoByPhoneAndPassword(@Param("phone") String phone, @Param("password") String password);-->
    <select id="selectInfoByPhoneAndPassword" resultType="org">
        select *
        from user_organization
        where `phone` = #{phone}
          and `password` = #{password}
    </select>
<!--新增的查询组织名称是否存在的方法-->
    <select id="checkOrgName" resultType="org">
        select *
        from user_organization
        where `name` = #{name}
    </select>
    <!--新增的查询组织phone是否存在的方法-->
    <select id="checkOrgPhone" resultType="org">
        select *
        from user_organization
        where `phone` = #{phone}
    </select>

    <!--void addOrg(Organizer org);-->
    <!--头像，姓名，管理者学号，联系手机号码(登陆)，密码，学院-->
    <insert id="addOrg" parameterType="org" useGeneratedKeys="true" keyProperty="id" databaseId="mysql">
        insert into user_organization(`name`, `level`, `managercount`, `phone`, `password`, `pic_org`, `collage`)
        values (#{name}, #{level}, #{mangerCount}, #{phone}, #{password}, #{headPortrait}, #{collage})
    </insert>

    <!--String getHeadPortrait(@Param("id") Integer id);-->
    <select id="getHeadPortrait" resultType="string">
        select pic_org
        from user_organization
        where id = #{id}
    </select>

    <!--void addInfo(@Param("id") Integer id);-->
    <insert id="addInfo" databaseId="mysql">
        insert into info_organization(`id`, `info`)
        values (#{id}, #{info})
    </insert>

    <!--String selectInfo(@Param("id")Integer id);-->
    <select id="selectInfo" resultType="string">
        select info
        from info_organization
        where id = #{id}
    </select>

    <!--    List<Organizer> getOrgs(@Param("num1") Integer number1,@Param("num2") Integer number2);   -->
    <select id="getOrgs" resultType="org">
        select
            `id`,`name`,`level`,`managercount` mangerCount,`phone`,`password`,`pic_org` headPortrait,`collage`
        from
            user_organization
        where 1=1
        order by
            id
            asc
        limit #{num1},#{num2}
    </select>

    <!--Integer countAllOrg();-->
    <select id="countAllOrg" resultType="Integer">
        select count(*)
        from user_organization
    </select>

    <!--Organizer selectOrgByHeadPortrait(@Param("picCode")String picCode);-->
    <select id="selectOrgByHeadPortrait" resultType="org">
        select
               *
        from
             user_organization
        where
              pic_org=#{picCode}
    </select>

    <!--List<Organizer> queryOrgsByName(@Param("name") String name);-->
    <select id="queryOrgsByName" resultType="org">
        select *
        from
            user_organization
        where
                `name`
                like
                '%${name}%'
    </select>
<!--    &lt;!&ndash;List<Organizer> getOrgSearch(@Param("nameSer")String name);&ndash;&gt;-->
<!--    <select id="getOrgSearch" resultType="org">-->
<!--        select-->
<!--            * from-->
<!--            user_organization-->
<!--        where-->
<!--                `name`-->
<!--                like-->
<!--                '%${nameSer}%'-->
<!--    </select>-->
</mapper>